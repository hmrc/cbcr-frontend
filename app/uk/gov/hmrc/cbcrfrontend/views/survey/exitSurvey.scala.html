@*
 * Copyright 2023 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.cbcrfrontend.controllers.routes
@import uk.gov.hmrc.cbcrfrontend.views.html.Layout

@this(
        layout: Layout,
        formHelper: FormWithCSRF,
        govukRadios: GovukRadios,
        govukButton: GovukButton,
        govukTextarea: GovukTextarea,
        govukErrorSummary: GovukErrorSummary
)

@(form:Form[_])(implicit request: Request[_], messages: Messages)

@hasErrors= @{form.hasErrors}
@title = @{messages("survey.title")}
@satisfiedKey = @{"satisfied"}
@suggestionsKey = @{"suggestions"}

@layout(title, hasErrors = hasErrors, withSignOutLink = false) {
    @if(hasErrors) {
        @govukErrorSummary(ErrorSummary(
            title = Text(messages("start.error.heading")),
            errorList = Seq(ErrorLink(
                content = Text(messages("survey.required")),
                href = Some(s"#${satisfiedKey}")
            )),
            attributes = Map("id" -> "error-summary-display")
        ))
    }
    <h1 class="govuk-heading-l">@title</h1>
    <p class="govuk-body">@messages("survey.intro")</p>
    @formHelper(routes.ExitSurveyController.submit){
        @govukRadios(Radios(
            fieldset = Some(Fieldset(
                legend = Some(Legend(
                    content = Text(messages("survey.question1")),
                    classes = "govuk-fieldset__legend--m"
                ))
            )),
            name = satisfiedKey,
            idPrefix = Some(satisfiedKey),
            errorMessage = if(hasErrors) Some(ErrorMessage(
                content = Text(messages("survey.required"))
            )) else None,
            items = Seq(
                RadioItem(
                    content = Text(messages("survey.one")),
                    value = Some(messages("survey.one"))
                ),
                RadioItem(
                    content = Text(messages("survey.two")),
                    value = Some(messages("survey.two"))
                ),
                RadioItem(
                    content = Text(messages("survey.three")),
                    value = Some(messages("survey.three"))
                ),
                RadioItem(
                    content = Text(messages("survey.four")),
                    value = Some(messages("survey.four"))
                ),
                RadioItem(
                    content = Text(messages("survey.five")),
                    value = Some(messages("survey.five"))
                )
            )
        ))

        <h2 class="govuk-heading-m">@messages("survey.question2")</h2>
        @govukTextarea(Textarea(
            id = suggestionsKey,
            name = suggestionsKey,
            rows = 5,
            label = Label(
                content = Text(messages("survey.enterFeedback"))
            ),
            hint = Some(Hint(
                content = Text(messages("survey.question2.hint"))
            )),
            value = form.data.get(suggestionsKey)
        ))
        @govukButton(Button(
            content = Text(messages("survey.send")),
            attributes = Map("id" -> "continue", "type" -> "submit")
        ))

    }

}
