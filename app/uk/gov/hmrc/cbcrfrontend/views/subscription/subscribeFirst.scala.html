@*
 * Copyright 2017 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.play.views.html.helpers._
@import uk.gov.hmrc.cbcrfrontend.AppConfig
@import uk.gov.hmrc.cbcrfrontend.views.html._
@import uk.gov.hmrc.cbcrfrontend.model.KnownFacts

@(asideCbc: Html, phaseBannerBeta: Html, knownFactsForm:Form[KnownFacts], noMatchingBusiness:Boolean = false)(
implicit request: Request[_], messages: Messages)

@sidebarContent = {
@asideCbc
}
@utrErrors = @{knownFactsForm.error("utr").isDefined}
@postCodeErrors = @{knownFactsForm.error("postCode").isDefined}

@main_template("Country by Country Reporting", sidebarLinks = Some(sidebarContent)) {
@phaseBannerBeta

 <div class="grid-row">
  <div class="column-two-thirds">

   <h1>
    @Messages("subscribeFirst.mainHeading")
   </h1>

   <p>@Messages("subscribeFirst.formHeading")</p>
      @if(noMatchingBusiness){
              <div class="flash error-summary error-summary--show" id="error-summary-display" role="alert" aria-labelledby="error-summary-heading" tabindex="-1">
                  <h2 id="error-summary-heading" class="h3-heading">@Messages("subscribeFirst.noMatchingBusiness.heading")s</h2>
                  <ul>
                      <li role="tooltip">@Messages("subscribeFirst.noMatchingBusiness.suggestion1")</li>
                      <li role="tooltip">@Messages("subscribeFirst.noMatchingBusiness.suggestion2")</li>
                      <li role="tooltip">@Messages("subscribeFirst.noMatchingBusiness.suggestion3")</li>
                  </ul>
              </div>
      }

      @form(action=uk.gov.hmrc.cbcrfrontend.controllers.routes.Subscription.checkKnownFacts()) {
          <fieldset>
              <div class="form-field form-field--tall @if(utrErrors){form-field--error }">
                 @if(utrErrors){ <span class="error-notification">@Messages("subscribeFirst.utrErrors.errorNotification")</span> }

                  <label>@Messages("subscribeFirst.utrLabel")</label>
                  @if(utrErrors) {
                      <span class="form-hint">@Messages("subscribeFirst.utrErrors.formHint")</span>
                  }

                  <input class="@{ if(utrErrors){ "input--medium error-field" } else { "form-control--block" } }"
                  type="text" name="utr" id="utr" value="@if(!utrErrors)@{knownFactsForm.data.get("utr")}"/>
              </div>

              <div class="form-field  @if(postCodeErrors){form-field--error } else { form-field--tall } ">
                  @if(postCodeErrors){ <span class="error-notification">@Messages("subscribeFirst.postcodeErrors.errorNotification")</span> }

                  <label>@Messages("subscribeFirst.postcodeLabel")</label>

                      <input class="@{ if(postCodeErrors){ "input--medium error-field" } else {"form-control--block"} }"
                      type="text" name="postCode" id="postCode" value="@if(!postCodeErrors)@{knownFactsForm.data.get("postCode")}"/>
              </div>
          </fieldset>

          <p>
              <button type="submit" role="button">@Messages("form.controls.continue")</button>
          </p>

      }

  </div>
 </div>

}
